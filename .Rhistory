library(readr)
require(dplyr, quietly = T)
library(ggplot2)
library(ggpubr)
library(VIM)
library(stringr)
luftqual.PM10.2 <- luftqual.PM10 %>%
mutate(Jahr = strtrim(luftqual.PM10$Datum, 4)) %>%
drop_na() %>%
group_by(Jahr, Station) %>%
summarize(n = sum(PM10_uberschritt, na.rm = T))
fun_A4 <- function(anzahl){
testen <- binom.test(x = anzahl, n = 365, p = 1/365, alternative = "greater", conf.level = 0.99)
return(ifelse(testen$p.value<0.01, T, F))
}
luftqual.PM10.2$h1 <- apply(luftqual.PM10.2$n, 1, fun_A4)
?apply
dim(luftqual.PM10.2$n)
dim(luftqual.PM10.2)
dim(luftqual.PM10.2[3,])
dim(luftqual.PM10.2[,3])
fun_A4 <- function(anzahl){
testen <- binom.test(x = anzahl, n = 365, p = 1/365, alternative = "greater", conf.level = 0.99)
return(ifelse(testen$p.value<0.01, T, F))
}
luftqual.PM10.2$h1 <- apply(luftqual.PM10.2[,3], 1, fun_A4)
?geom_text
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, color = Station)) +
geom_col(aes(fill = Station),position = "dodge") +
geom_label(aes(labels = luftqual.PM10.2$h1))
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, color = Station)) +
geom_col(aes(fill = Station),position = "dodge") +
geom_label(aes(label = luftqual.PM10.2$h1))
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, color = Station)) +
geom_col(aes(fill = Station),position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1))
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, color = Station)) +
geom_col(aes(fill = Station),position = "dodge") +
geom_labels(aes(label = luftqual.PM10.2$h1), vjust = 90)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, color = Station)) +
geom_col(aes(fill = Station),position = "dodge") +
geom_label(aes(label = luftqual.PM10.2$h1), vjust = 90)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, color = Station)) +
geom_col(aes(fill = Station),position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1, color = "black"))
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, color = Station)) +
geom_col(aes(fill = Station),position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black")
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, color = Station)) +
geom_col(aes(fill = Station),position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1),
color = "black", position = position_dodge(width=0.9),  size=20)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, color = Station)) +
geom_col(aes(fill = Station),position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1),
color = "black", position = position_dodge(width=0.9),  size=5)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, color = Station)) +
geom_col(aes(fill = Station),position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1),
color = "black", position = position_dodge(width=0.1),  size=5)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, color = Station)) +
geom_col(aes(fill = Station),position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=5)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, color = Station)) +
geom_col(aes(fill = Station),position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, color = Station)) +
geom_col(aes(fill = Station),position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4, angle = 90)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, color = Station)) +
geom_col(aes(fill = Station),position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4, angle = 90, vjust = 5)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, color = Station)) +
geom_col(aes(fill = Station),position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, color = Station)) +
geom_col(aes(fill = Station),position = "dodge") +
geom_text(aes(label = c("h1: ", luftqual.PM10.2$h1)), color = "black",  size=4)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, color = Station)) +
geom_col(aes(fill = Station),position = "dodge") +
geom_text(aes(label = c("h1: "+ luftqual.PM10.2$h1)), color = "black",  size=4)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, color = Station)) +
geom_col(aes(fill = Station),position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4, position = position_stack(vjust = .5))
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, color = Station)) +
geom_col(aes(fill = Station),position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4, position = position_dodge(vjust = .5))
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, color = Station)) +
geom_col(aes(fill = Station),position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4, position = position_dodge())
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, color = Station)) +
geom_col(aes(fill = Station),position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4, position = position_dodge(width = .5))
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(),position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4, position = position_dodge(width = .5))
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4, position = position_dodge(width = 1)
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4, position = position_dodge(width = 1)
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4, position = position_dodge(width = 1)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4, position = position_dodge(width = 1))
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge(width = 1))
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1))
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 90)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=3,
position = position_dodge2(width = 1), angle = 90)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=3,
position = position_dodge2(width = 1), angle = 90, vjust = 1)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=3,
position = position_dodge2(width = 1), angle = 90, hjust = 1)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=5,
position = position_dodge2(width = 1), angle = 90, hjust = 2)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=5,
position = position_dodge2(width = 1), angle = 90, hjust = 1)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=5,
position = position_dodge2(width = 1), angle = 90, hjust = 1.1)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=5,
position = position_dodge2(width = 1), angle = 90, hjust = 1.1, vjust = .1)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=5,
position = position_dodge2(width = 1), angle = 90, hjust = 1)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 90, hjust = 1)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=5,
position = position_dodge2(width = 1), angle = 90, hjust = 1)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 90, hjust = 1.05)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = 1.05)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = 0)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = 0)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = -.5)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = .1)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = .15)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = .2)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = .5)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = -.5)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = -.1)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = -.1) +
scale_fill_manual("h1 angenommen")
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = -.1) +
scale_fill_manual("h1 angenommen", values = c("TRUE", "FALSE"))
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = -.1) +
scale_fill_manual("h1 angenommen", values = c("TRUE", "FALSE", "hallo"))
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = -.1) +
scale_color_manual("h1 angenommen", values = c("TRUE", "FALSE"))
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = -.1) +
scale_color_manual("h1 angenommen", values = c(True = "red", False = "blue"))
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = -.1) +
scale_color_manual("h1 angenommen", values = c(True = "red", False = "blue",
guide = guide_legend(override.aes = list(fill = NA))))
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = -.1) +
scale_color_manual("h1 angenommen", labels = c("TRUE", "FALSE"), values = c("black", "black"))
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = -.1) +
scale_color_manual("h1 angenommen", labels = c("TRUE", "FALSE"), values = c("black", "red"))
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = -.1) +
scale_color_hue("h1 angenommen", labels = c("TRUE", "FALSE"), values = c("black", "red"))
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = -.1) +
scale_color_hue("h1 angenommen", labels = c("TRUE", "FALSE"))
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = -.1) +
scale_color_discrete(name = "h1 angenommen", labels = c("TRUE", "FALSE"))
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1, labels = c(1,2)), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = -.1) +
scale_color_discrete(name = "h1 angenommen", labels = c("TRUE", "FALSE"))
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = -.1) +
annotation_custom(grob = textGrob("h1 angenommen"),
xmin = 2, xmax = 2, ymin = -4.5, ymax = -4.55)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = -.1) +
annotation_custom(grob = textGrob("h1 angenommen"),
xmin = 0, xmax = 0, ymin = 0, ymax = 0)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = -.1) +
annotation_custom(grob = textGrob("h1 angenommen"),
xmin = 0, xmax = 90, ymin = 0, ymax = 0)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = -.1) +
annotation_custom(grob = textGrob("h1 angenommen"),
xmin = 0, xmax = -90, ymin = 0, ymax = 0)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = -.1) +
annotation_custom(grob = textGrob("h1 angenommen"),
xmin = 10, xmax = 0, ymin = 0, ymax = 0)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = -.1) +
annotation_custom(grob = textGrob("h1 angenommen"),
xmin = 15, xmax = 0, ymin = 0, ymax = 0)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = -.1) +
annotation_custom(grob = textGrob("h1 angenommen"),
xmin = 17, xmax = 0, ymin = 0, ymax = 0)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = -.1) +
annotation_custom(grob = textGrob("h1 angenommen"),
xmin = 17, xmax = 20, ymin = 0, ymax = 0)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = -.1)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = -.1) +
annotate("text", x=8, y=13000, label= "boat") +
#### Aufgabe 5 ####
# Regendauer zu allen Stationen hinzufuegen
ordered_PM10 <- left_join(x = select(luftqual, Datum,`Feinstaub PM10`, Station),
y = filter(luftqual, Station == "Stampfenbachstrasse") %>% select( Datum, Regendauer),
by = "Datum")
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = -.1) +
annotate("text", x=8, y=20, label= "boat") +
#### Aufgabe 5 ####
# Regendauer zu allen Stationen hinzufuegen
ordered_PM10 <- left_join(x = select(luftqual, Datum,`Feinstaub PM10`, Station),
y = filter(luftqual, Station == "Stampfenbachstrasse") %>% select( Datum, Regendauer),
by = "Datum")
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = -.1) +
annotate("text", x=8, y=20, label= "boat")
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = -.1) +
annotate_custom("text", x=8, y=20, label= "boat")
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = -.1) +
annotation_custom("text", x=8, y=20, label= "boat")
?annotation_custom
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = -.1) +
annotation_custom(grob = "text", xmin=8, xmax=8, ymin=20, ymax=20)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = -.1) +
annotation_custom(grob = textGrob(label = "hallo"), xmin=8, xmax=8, ymin=20, ymax=20)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = -.1) +
annotation_custom(grob = textGrob(label = "hallo"), xmin=0, xmax=0, ymin=0, ymax=0)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = -.1) +
geom_text(aes(label = "hallo"), x = 5, y = 5)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = -.1) +
geom_text(aes(label = "hallo"), x = 5, y = 5, size = 4)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = -.1) +
geom_text(aes(label = "hallo"), x = 5, y = 5, size = 5)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = -.1) +
geom_text(aes(label = "hallo"), x = 10, y = 5, size = 5)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = -.1) +
geom_text(aes(label = "hallo"), x = 8, y = 5, size = 5)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = -.1) +
geom_text(aes(label = "hallo"), x = 6, y = 5, size = 5)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = -.1) +
geom_text(aes(label = "hallo"), x = 7, y = 5, size = 5)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = -.1) +
geom_text(aes(label = "hallo"), x = 7.3, y = 5, size = 5)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = -.1) +
geom_text(aes(label = "hallo"), x = 7.5, y = 5, size = 5)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = -.1)
#### Aufgabe 5 ####
# Regendauer zu allen Stationen hinzufuegen
ordered_PM10 <- left_join(x = select(luftqual, Datum,`Feinstaub PM10`, Station),
y = filter(luftqual, Station == "Stampfenbachstrasse") %>% select( Datum, Regendauer),
by = "Datum")
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge")
binom.test(x = 5, n = 365, p = 1/365, alternative = "greater", conf.level = 0.99)
binom.test(x = 4, n = 365, p = 1/365, alternative = "greater", conf.level = 0.99)
