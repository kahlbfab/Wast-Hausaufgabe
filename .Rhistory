position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = -.1) +
annotation_custom(grob = textGrob("h1 angenommen"),
xmin = 17, xmax = 20, ymin = 0, ymax = 0)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = -.1)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = -.1) +
annotate("text", x=8, y=13000, label= "boat") +
#### Aufgabe 5 ####
# Regendauer zu allen Stationen hinzufuegen
ordered_PM10 <- left_join(x = select(luftqual, Datum,`Feinstaub PM10`, Station),
y = filter(luftqual, Station == "Stampfenbachstrasse") %>% select( Datum, Regendauer),
by = "Datum")
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = -.1) +
annotate("text", x=8, y=20, label= "boat") +
#### Aufgabe 5 ####
# Regendauer zu allen Stationen hinzufuegen
ordered_PM10 <- left_join(x = select(luftqual, Datum,`Feinstaub PM10`, Station),
y = filter(luftqual, Station == "Stampfenbachstrasse") %>% select( Datum, Regendauer),
by = "Datum")
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = -.1) +
annotate("text", x=8, y=20, label= "boat")
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = -.1) +
annotate_custom("text", x=8, y=20, label= "boat")
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = -.1) +
annotation_custom("text", x=8, y=20, label= "boat")
?annotation_custom
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = -.1) +
annotation_custom(grob = "text", xmin=8, xmax=8, ymin=20, ymax=20)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = -.1) +
annotation_custom(grob = textGrob(label = "hallo"), xmin=8, xmax=8, ymin=20, ymax=20)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = -.1) +
annotation_custom(grob = textGrob(label = "hallo"), xmin=0, xmax=0, ymin=0, ymax=0)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = -.1) +
geom_text(aes(label = "hallo"), x = 5, y = 5)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = -.1) +
geom_text(aes(label = "hallo"), x = 5, y = 5, size = 4)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = -.1) +
geom_text(aes(label = "hallo"), x = 5, y = 5, size = 5)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = -.1) +
geom_text(aes(label = "hallo"), x = 10, y = 5, size = 5)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = -.1) +
geom_text(aes(label = "hallo"), x = 8, y = 5, size = 5)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = -.1) +
geom_text(aes(label = "hallo"), x = 6, y = 5, size = 5)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = -.1) +
geom_text(aes(label = "hallo"), x = 7, y = 5, size = 5)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = -.1) +
geom_text(aes(label = "hallo"), x = 7.3, y = 5, size = 5)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = -.1) +
geom_text(aes(label = "hallo"), x = 7.5, y = 5, size = 5)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label = luftqual.PM10.2$h1), color = "black",  size=4,
position = position_dodge2(width = 1), angle = 0, hjust = .5, vjust = -.1)
#### Aufgabe 5 ####
# Regendauer zu allen Stationen hinzufuegen
ordered_PM10 <- left_join(x = select(luftqual, Datum,`Feinstaub PM10`, Station),
y = filter(luftqual, Station == "Stampfenbachstrasse") %>% select( Datum, Regendauer),
by = "Datum")
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge")
binom.test(x = 5, n = 365, p = 1/365, alternative = "greater", conf.level = 0.99)
binom.test(x = 4, n = 365, p = 1/365, alternative = "greater", conf.level = 0.99)
luftqual.PM10
luftqual.PM10.2
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge")
library(ggplot2)
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge")
# Plot dazu
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge")
luftqual.PM10.2 <- luftqual.PM10 %>%
mutate(Jahr = strtrim(luftqual.PM10$Datum, 4)) %>%
drop_na() %>%
group_by(Jahr, Station) %>%
summarize(n = sum(PM10_uberschritt, na.rm = T))
luftqual.PM10 <- luftqual %>% ungroup() %>%
select(Datum, 'Feinstaub PM10', Station) %>%  # nur relevante Kolumnen
filter(Station != "Heubeeribüel") %>%
mutate(PM10_uberschritt = `Feinstaub PM10` >= 50 )
# Alle librarys einlesen
library("tidyr")
library(readr)
require(dplyr, quietly = T)
library(ggplot2)
library(ggpubr)
library(VIM)
library(stringr)
luftqual.PM10 <- luftqual %>% ungroup() %>%
select(Datum, 'Feinstaub PM10', Station) %>%  # nur relevante Kolumnen
filter(Station != "Heubeeribüel") %>%
mutate(PM10_uberschritt = `Feinstaub PM10` >= 50 )
head(luftqual.PM10)
luftqual.PM10 %>% group_by(Station) %>% summarize(n = sum(PM10_uberschritt, na.rm = T))
luftqual.PM10 %>% filter(PM10_uberschritt) %>%
ggplot(aes(x=Datum, y=`Feinstaub PM10`)) + geom_point(aes(color = Station)) + ggtitle(" Überschrittene Tagesmittelgrenzwerte (PM10 > 50)")
luftqual.PM10.2 <- luftqual.PM10 %>%
mutate(Jahr = strtrim(luftqual.PM10$Datum, 4)) %>%
drop_na() %>%
group_by(Jahr, Station) %>%
summarize(n = sum(PM10_uberschritt, na.rm = T))
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge")
luftqual.PM10.2 <- luftqual.PM10 %>%
mutate(Jahr = strtrim(luftqual.PM10$Datum, 4)) %>%
drop_na() %>%
group_by(Jahr, Station) %>%
summarize(n = sum(PM10_uberschritt, na.rm = T))
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge")
fun_A4 <- function(anzahl){
testen <- binom.test(x = anzahl, n = 365, p = 1/365, alternative = "greater", conf.level = 0.99)
return(ifelse(testen$p.value<0.01, T, F))
}
luftqual.PM10.2$h1 <- apply(luftqual.PM10.2[,3], 1, fun_A4)
luftqual.PM10.2$h1
fun_A4 <- function(anzahl){
testen <- binom.test(x = anzahl, n = 365, p = 1/365, alternative = "greater", conf.level = 0.99)
return(ifelse(testen$p.value<0.01, T, F))
}
luftqual.PM10.2$h1 <- apply(luftqual.PM10.2[,3], 1, fun_A4)
luftqual.PM10.2
fun_A4 <- function(anzahl){
testen <- binom.test(x = anzahl, n = 365, p = 1/365, alternative = "greater", conf.level = 0.99)
return(ifelse(testen$p.value<0.01, T, F))
}
luftqual.PM10.2$h1 <- apply(luftqual.PM10.2[,3], 1, fun_A4)
luftqual.PM10.2
luftqual.PM10.2
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label=h1), vjust=0) +
opts(axis.text.x=theme_blank(),
axis.ticks=theme_blank(),
axis.title.x=theme_blank(),
legend.title=theme_blank(),
axis.title.y=theme_blank()
)
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label=h1), vjust=0)
# opts(axis.text.x=theme_blank(),
#     axis.ticks=theme_blank(),
#     axis.title.x=theme_blank(),
#     legend.title=theme_blank(),
#     axis.title.y=theme_blank()
)
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label=h1), vjust=0)
# opts(axis.text.x=theme_blank(),
#     axis.ticks=theme_blank(),
#     axis.title.x=theme_blank(),
#     legend.title=theme_blank(),
#     axis.title.y=theme_blank()
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label=h1), vjust=0, parse = T)
# opts(axis.text.x=theme_blank(),
#     axis.ticks=theme_blank(),
#     axis.title.x=theme_blank(),
#     legend.title=theme_blank(),
#     axis.title.y=theme_blank()
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label=h1), vjust=0, annotate(angle=90))
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label=h1), vjust=0, annotate(geom="text", angle=90))
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label=h1), vjust=0, annotate(geom=h1, angle=90))
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") #+
#geom_text(aes(label=h1), vjust=0, annotate(geom="text", angle=90))
# opts(axis.text.x=theme_blank(),
#     axis.ticks=theme_blank(),
#     axis.title.x=theme_blank(),
#     legend.title=theme_blank(),
#     axis.title.y=theme_blank()
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label=h1), vjust=0)
# opts(axis.text.x=theme_blank(),
#     axis.ticks=theme_blank(),
#     axis.title.x=theme_blank(),
#     legend.title=theme_blank(),
#     axis.title.y=theme_blank()
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label=h1), vjust=0) + geom_text(angle=90)
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label=h1),angle = 90, vjust=0)
# opts(axis.text.x=theme_blank(),
#     axis.ticks=theme_blank(),
#     axis.title.x=theme_blank(),
#     legend.title=theme_blank(),
#     axis.title.y=theme_blank()
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label=h1),angle = 90)
# opts(axis.text.x=theme_blank(),
#     axis.ticks=theme_blank(),
#     axis.title.x=theme_blank(),
#     legend.title=theme_blank(),
#     axis.title.y=theme_blank()
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label=h1),angle = 90, position = "dodge")
# opts(axis.text.x=theme_blank(),
#     axis.ticks=theme_blank(),
#     axis.title.x=theme_blank(),
#     legend.title=theme_blank(),
#     axis.title.y=theme_blank()
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label=h1),angle = 90, position = position_dodge(0.9))
# opts(axis.text.x=theme_blank(),
#     axis.ticks=theme_blank(),
#     axis.title.x=theme_blank(),
#     legend.title=theme_blank(),
#     axis.title.y=theme_blank()
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label=h1),angle = 90, position = position_dodge(0.9), vjust = 0)
# opts(axis.text.x=theme_blank(),
#     axis.ticks=theme_blank(),
#     axis.title.x=theme_blank(),
#     legend.title=theme_blank(),
#     axis.title.y=theme_blank()
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label=h1, h1 = h1 +0.05),angle = 90, position = position_dodge(0.9))
# opts(axis.text.x=theme_blank(),
#     axis.ticks=theme_blank(),
#     axis.title.x=theme_blank(),
#     legend.title=theme_blank(),
#     axis.title.y=theme_blank()
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label=h1, y = y +0.05),angle = 90, position = position_dodge(0.9))
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label=h1, h1 = h1 +0.05),angle = 90, position = position_dodge(0.9), vjust=0)
# opts(axis.text.x=theme_blank(),
#     axis.ticks=theme_blank(),
#     axis.title.x=theme_blank(),
#     legend.title=theme_blank(),
#     axis.title.y=theme_blank()
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label=h1, h1 = h1 +0.05),angle = 90, position = position_dodge(0.9), vjust=0)
# opts(axis.text.x=theme_blank(),
#     axis.ticks=theme_blank(),
#     axis.title.x=theme_blank(),
#     legend.title=theme_blank(),
#     axis.title.y=theme_blank()
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label=h1, h1 = h1 +0.1),angle = 90, position = position_dodge(0.9), vjust=0)
# opts(axis.text.x=theme_blank(),
#     axis.ticks=theme_blank(),
#     axis.title.x=theme_blank(),
#     legend.title=theme_blank(),
#     axis.title.y=theme_blank()
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label=h1, h1 = h1 +1),angle = 90, position = position_dodge(0.9), vjust=0)
# opts(axis.text.x=theme_blank(),
#     axis.ticks=theme_blank(),
#     axis.title.x=theme_blank(),
#     legend.title=theme_blank(),
#     axis.title.y=theme_blank()
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label=h1, h1 = h1 +2),angle = 90, position = position_dodge(0.9), vjust=0)
# opts(axis.text.x=theme_blank(),
#     axis.ticks=theme_blank(),
#     axis.title.x=theme_blank(),
#     legend.title=theme_blank(),
#     axis.title.y=theme_blank()
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label=h1, h1 = h1 +5),angle = 90, position = position_dodge(0.9), vjust=0)
# opts(axis.text.x=theme_blank(),
#     axis.ticks=theme_blank(),
#     axis.title.x=theme_blank(),
#     legend.title=theme_blank(),
#     axis.title.y=theme_blank()
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label=h1),angle = 90, position = position_stack(vjust = 0.5))
# opts(axis.text.x=theme_blank(),
#     axis.ticks=theme_blank(),
#     axis.title.x=theme_blank(),
#     legend.title=theme_blank(),
#     axis.title.y=theme_blank()
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label=h1),angle = 90, position = position_dodge(0.9))
# opts(axis.text.x=theme_blank(),
#     axis.ticks=theme_blank(),
#     axis.title.x=theme_blank(),
#     legend.title=theme_blank(),
#     axis.title.y=theme_blank()
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label=h1, n= n+0.1),angle = 90, position = position_dodge(0.9))
# opts(axis.text.x=theme_blank(),
#     axis.ticks=theme_blank(),
#     axis.title.x=theme_blank(),
#     legend.title=theme_blank(),
#     axis.title.y=theme_blank()
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label=h1, n= n+2),angle = 90, position = position_dodge(0.9))
# opts(axis.text.x=theme_blank(),
#     axis.ticks=theme_blank(),
#     axis.title.x=theme_blank(),
#     legend.title=theme_blank(),
#     axis.title.y=theme_blank()
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label=h1, n= n+5),angle = 90, position = position_dodge(0.9))
# opts(axis.text.x=theme_blank(),
#     axis.ticks=theme_blank(),
#     axis.title.x=theme_blank(),
#     legend.title=theme_blank(),
#     axis.title.y=theme_blank()
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label=h1),angle = 90, position = position_dodge(0.9), nudge_y = 2)
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label=h1),angle = 90, position = position_dodge(0.9))
# opts(axis.text.x=theme_blank(),
#     axis.ticks=theme_blank(),
#     axis.title.x=theme_blank(),
#     legend.title=theme_blank(),
#     axis.title.y=theme_blank()
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label=h1),angle = 90, position = position_dodge(0.9))
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label=h1),angle = 90, position = position_dodge(0.9))
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label=h1),angle = 90, position = position_dodge(0.9))
# Alle librarys einlesen
library("tidyr")
library(readr)
require(dplyr, quietly = T)
library(ggplot2)
library(ggpubr)
library(VIM)
library(stringr)
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label=h1),angle = 90, position = position_dodge(0.9))
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label=h1),angle = 90, position = position_dodge(0.9), vjust = 1)
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label=h1),angle = 90, position = position_dodge(0.9), hjust = 1)
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label=h1),angle = 90, position = position_dodge(0.9), hjust = 1, size = 0.8)
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label=h1),angle = 90, position = position_dodge(0.9), hjust = 1, size = 11)
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label=h1),angle = 90, position = position_dodge(0.9), hjust = 1, size = 5)
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label=h1),angle = 90, position = position_dodge(0.9), hjust = 1, size = 3)
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label=h1),angle = 90, position = position_dodge(0.9), hjust = 1, size = 3.5)
fun_A4 <- function(anzahl){
testen <- binom.test(x = anzahl, n = 365, p = 1/365, alternative = "greater", conf.level = 0.99)
return(ifelse(testen$p.value<0.01, "H1", "H0"))
}
luftqual.PM10.2$h <- apply(luftqual.PM10.2[,3], 1, fun_A4)
luftqual.PM10.2
luftqual.PM10.2 <- luftqual.PM10 %>%
mutate(Jahr = strtrim(luftqual.PM10$Datum, 4)) %>%
drop_na() %>%
group_by(Jahr, Station) %>%
summarize(n = sum(PM10_uberschritt, na.rm = T))
fun_A4 <- function(anzahl){
testen <- binom.test(x = anzahl, n = 365, p = 1/365, alternative = "greater", conf.level = 0.99)
return(ifelse(testen$p.value<0.01, "H1", "H0"))
}
luftqual.PM10.2$h <- apply(luftqual.PM10.2[,3], 1, fun_A4)
luftqual.PM10.2
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label=h),angle = 90, position = position_dodge(0.9), hjust = 1, size = 3.5)+
geom_hline(aes(y=5))
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label=h),angle = 90, position = position_dodge(0.9), hjust = 1, size = 3.5)+
geom_hline(5)
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label=h),angle = 90, position = position_dodge(0.9), hjust = 1, size = 3.5)+
geom_hline(yintercept = 5)
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label=h),angle = 90, position = position_dodge(0.9), hjust = 1, size = 3.5)+
geom_hline(yintercept = 5, col = "red")
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label=h),angle = 90, position = position_dodge(0.9), hjust = 1, size = 3.5)+
geom_hline(yintercept = 5, col = "red")
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label=h),angle = 90, position = position_dodge(0.9), hjust = 1, size = 4)+
geom_hline(yintercept = 5, col = "red")
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label=h),angle = 90, position = position_dodge(0.9), hjust = 1, size = 4)+
geom_hline(yintercept = 5, col = "red")
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label=h),angle = 90, position = position_dodge(0.9), hjust = 1, size = 4)+
geom_hline(yintercept = 4.5, col = "red")
ggplot(luftqual.PM10.2, aes(x = Jahr, y = n, fill = Station)) +
geom_col(aes(), position = "dodge") +
geom_text(aes(label=h),angle = 90, position = position_dodge(0.9), hjust = 1, size = 4)+
geom_hline(yintercept = 4.5, col = "red")
