library("tidyr")
library(readr)
require(dplyr, quietly = T)
library(ggplot2)
library(ggplot2)
#daten einlesen
ugz_luftqualitaetsmessung_seit_2012 <- read_csv("ugz_luftqualitaetsmessung_seit-2012.csv")
luftqualitaet <- as_tibble(ugz_luftqualitaetsmessung_seit_2012)
#werte und titel separieren
titel <- slice(luftqualitaet, c(2))
titel[1] <- "Datum"
werte <- slice(luftqualitaet, c(-1:-5))
#tabelle nach ort auseinander nehmen
stampfenbach <- werte %>% select(1,2:14) %>%
mutate(station = "Stampfenbachstrasse")
stampfenbach_titel <- titel %>% select(1,2:14)
stampfenbach_titel[15] <- "Station"
names(stampfenbach) <- stampfenbach_titel
schimmel <- werte %>% select(1,15:22) %>%
mutate(station = "Schimmelstrasse")
schimmel_titel <- titel %>% select(1,15:22)
schimmel_titel[10] <- "Station"
names(schimmel) <- schimmel_titel
heubeer <- werte %>% select(1,23:26) %>%
mutate(station = "Heubeeribüel")
heubeer_titel <- titel %>% select(1,23:26)
heubeer_titel[6] <- "Station"
names(heubeer) <- heubeer_titel
rosengarten <- werte %>% select(1,27:30) %>%
mutate(station = "Rosengarten")
rosengarten_titel <- titel %>% select(1,27:30)
rosengarten_titel[6] <- "Station"
names(rosengarten) <- rosengarten_titel
#tabelle zusammensetzen
luftqual <- bind_rows(stampfenbach, schimmel, heubeer, rosengarten)
str(luftqual)
luftqual[2:14] <- as_tibble(sapply(luftqual[2:14], as.numeric))
str(luftqual)
View(luftqual)
luftqual
?sapply
?lapply
?sapply
?lapply
str(luftqual)
View(luftqual)
View(luftqual)
#### Aufgabe 2 ####
#mit ggplot
gather(luftqual, key = variable, value = value, c(2,3,4,6,7,8)) %>%
ggplot(aes(x = Datum, y = value, group = variable)) +
geom_line(aes(color = variable)) +
facet_wrap(~Station)
luftqual.NA <- luftqual %>% select(everything()) %>% summarise_all(funs(sum(is.na(.)))) %>%
gather(variable, value,c(2:14)) %>% select(c(3,4)) %>% ggplot(aes(reorder(x = c(1:13), -value) , y = value)) + xlab("")+
geom_bar(stat = "identity", aes(fill = variable)) + theme(axis.text.x = element_blank(), axis.ticks.x=element_blank())
luftqual.NA
luftqual.NA <- luftqual %>%
select(everything()) %>%
summarise_all(funs(sum(is.na(.)))) %>%
gather(variable, value,c(2:14)) %>%
select(c(3,4)) %>%
ggplot(aes(reorder(x = c(1:13), -value) , y = value)) + xlab("") +
geom_bar(stat = "identity", aes(fill = variable)) +
theme(axis.text.x = element_blank(), axis.ticks.x=element_blank())
luftqual.NA
luftqual %>%
select(everything()) %>%
summarise_all(funs(sum(is.na(.)))) %>%
gather(variable, value,c(2:14)) %>%
select(c(3,4)) %>%
ggplot(aes(reorder(x = c(1:13), -value) , y = value)) + xlab("") +
geom_bar(stat = "identity", aes(fill = variable)) +
theme(axis.text.x = element_blank(), axis.ticks.x=element_blank())
# uberschittene Tagesmittelgrenzwerte
luftqual.PM10 <- luftqual %>% select(Datum, 'Feinstaub PM10', Station) %>%
mutate(PM10_uberschritt = luftqual$`Feinstaub PM10` >= 50 )
#1 wie oft wird der Tagesmittel-Grenzwert an welcher Station ueberschritten?
luftqual.PM10 %>% group_by(Station) %>% summarize(n = sum(PM10_uberschritt, na.rm = T))
#2 ueberschrittenen Tagesmittelgrenzwerte fuer alle Stationen ueber die Zeit in einer Grafik
luftqual.PM10 %>% filter(PM10_uberschritt) %>%
ggplot(aes(x=Datum, y=`Feinstaub PM10`)) + geom_point(aes(color = Station)) + ggtitle("PM10 > 50")
# Messwerte sind iid: independent and identically distributed
punif(q=, min=0, max=365) # P[X <= x]
luftqual.PM10 %>% group_by(Station) %>% summarize(n = sum(PM10_uberschritt, na.rm = T)) %>%
mutate(wkeit_n = punif(q=n, min=0, max=365))
# regendauer zu allen Stationen hinzufuegen mit leftjoin
ordered_PM10 <- left_join(x = select(luftqual, Datum,`Feinstaub PM10`, Station),
y = filter(luftqual, Station == "Stampfenbachstrasse") %>% select( Datum, Regendauer),
by = "Datum")
#
ggplot(ordered_PM10, aes(x= Regendauer, y= `Feinstaub PM10`)) + geom_point(aes(color = Station))
library("tidyr")
library(readr)
require(dplyr, quietly = T)
library(ggplot2)
ugz_luftqualitaetsmessung_seit_2012 <- read_csv("ugz_luftqualitaetsmessung_seit-2012.csv")
luftqualitaet <- as_tibble(ugz_luftqualitaetsmessung_seit_2012)
titel <- slice(luftqualitaet, c(2))
titel[1] <- "Datum"
werte <- slice(luftqualitaet, c(-1:-5))
# Tabelle nach ort auseinander nehmen
stampfenbach <- werte %>% select(1,2:14) %>%
mutate(station = "Stampfenbachstrasse")
stampfenbach_titel <- titel %>% select(1,2:14)
stampfenbach_titel[15] <- "Station"
names(stampfenbach) <- stampfenbach_titel
schimmel <- werte %>% select(1,15:22) %>%
mutate(station = "Schimmelstrasse")
schimmel_titel <- titel %>% select(1,15:22)
schimmel_titel[10] <- "Station"
names(schimmel) <- schimmel_titel
heubeer <- werte %>% select(1,23:26) %>%
mutate(station = "Heubeeribüel")
heubeer_titel <- titel %>% select(1,23:26)
heubeer_titel[6] <- "Station"
names(heubeer) <- heubeer_titel
rosengarten <- werte %>% select(1,27:30) %>%
mutate(station = "Rosengarten")
rosengarten_titel <- titel %>% select(1,27:30)
rosengarten_titel[6] <- "Station"
names(rosengarten) <- rosengarten_titel
# Tabelle zusammensetzen
luftqual <- bind_rows(stampfenbach, schimmel, heubeer, rosengarten)
str(luftqual)
# Zahlen von character nach numeric wandeln
luftqual[2:14] <- as_tibble(sapply(luftqual[2:14], as.numeric))
sum(is.na(luftqual.A3))
source('~/GitHub/Wast-Hausaufgabe/HA_test_thomas.R', encoding = 'UTF-8')
sum(is.na(luftqual.A3))
library(VIM)
par(mar= c(4,2,2,2))
luftqual.A3 <- rapply(luftqual, f=function(x) ifelse(is.nan(x),NA,x), how="replace")
names(luftqual.A3) <- c("Datum", "SO2", "CO", "O3_max_h1", "O3_nb_h1>120", "NO2", "NO", "PM10", "T", "Hr", "p", "WVS", "StrGlo", "RainDur", "Station")
aggr_plot <- aggr(luftqual.A3, col=c('navyblue','red'),
numbers=TRUE, sortVars=TRUE, labels=names(luftqual.A3), cex.axis=.7, gap=3, ylab=c("Histogram of missing data","Pattern"), cex.lab = 1.2)
aggr_plot <- aggr(luftqual.A3, col=c('navyblue','red'),
numbers=TRUE, sortVars=TRUE, labels=names(luftqual.A3), cex.axis=.7, gap=3, ylab=c("Histogram of missing data","Pattern"), cex.lab = 0.7)
aggr_plot <- aggr(luftqual.A3, col=c('navyblue','red'),
numbers=TRUE, sortVars=TRUE, labels=names(luftqual.A3), cex.axis=.5, gap=3, ylab=c("Histogram of missing data","Pattern"), cex.lab = 0.7)
aggr_plot <- aggr(luftqual.A3, col=c('navyblue','red'),
numbers=TRUE, sortVars=TRUE, labels=names(luftqual.A3), cex.axis=.6, gap=3, ylab=c("Histogram of missing data","Pattern"), cex.lab = 0.7)
luftqual.A3 <- rapply(luftqual, f=function(x) ifelse(is.nan(x),NA,x), how="replace")
aggr_plot <- aggr(luftqual.A3, col=c('navyblue','red'),
numbers=TRUE, sortVars=TRUE, labels=names(luftqual.A3), cex.axis=.6, gap=3, ylab=c("Histogram of missing data","Pattern"), cex.lab = 0.7)
aggr_plot <- aggr(luftqual.A3, col=c('navyblue','red'),
numbers=TRUE, sortVars=TRUE, labels=names(luftqual.A3), cex.axis=.5, gap=3, ylab=c("Histogram of missing data","Pattern"), cex.lab = 0.7)
aggr_plot <- aggr(luftqual.A3, col=c('navyblue','red'),
numbers=TRUE, sortVars=TRUE, labels=names(luftqual.A3), cex.axis=.4, gap=3, ylab=c("Histogram of missing data","Pattern"), cex.lab = 0.7)
aggr_plot <- aggr(luftqual.A3, col=c('navyblue','red'),
numbers=TRUE, sortVars=TRUE, labels=names(luftqual.A3), cex.axis=.2, gap=3, ylab=c("Histogram of missing data","Pattern"), cex.lab = 0.7)
names(luftqual.A3) <- c("Datum", "SO2", "CO", "O3_max_h1", "O3_nb_h1>120", "NO2", "NO", "PM10", "T", "Hr", "p", "WVS", "StrGlo", "RainDur", "Station")
aggr_plot <- aggr(luftqual.A3, col=c('navyblue','red'),
numbers=TRUE, sortVars=TRUE, labels=names(luftqual.A3), cex.axis=.2, gap=3, ylab=c("Histogram of missing data","Pattern"), cex.lab = 0.7)
aggr_plot <- aggr(luftqual.A3, col=c('navyblue','red'),
numbers=TRUE, sortVars=TRUE, labels=names(luftqual.A3), cex.axis=1, gap=3, ylab=c("Histogram of missing data","Pattern"), cex.lab = 0.7)
aggr_plot <- aggr(luftqual.A3, col=c('navyblue','red'),
numbers=TRUE, sortVars=TRUE, labels=names(luftqual.A3), cex.axis=0.7, gap=3, ylab=c("Histogram of missing data","Pattern"), cex.lab = 0.7)
aggr_plot <- aggr(luftqual.A3, col=c('navyblue','red'),
numbers=TRUE, sortVars=TRUE, labels=names(luftqual.A3), cex.axis=0.7, gap=4, ylab=c("Histogram of missing data","Pattern"), cex.lab = 0.7)
aggr_plot <- aggr(luftqual.A3, col=c('navyblue','red'),
numbers=TRUE, sortVars=TRUE, labels=names(luftqual.A3), cex.axis=0.7, gap=1, ylab=c("Histogram of missing data","Pattern"), cex.lab = 0.7)
aggr_plot <- aggr(luftqual.A3, col=c('navyblue','red'),
numbers=TRUE, sortVars=TRUE, labels=names(luftqual.A3), cex.axis=0.7, gap=0.5, ylab=c("Histogram of missing data","Pattern"), cex.lab = 0.7)
aggr_plot <- aggr(luftqual.A3, col=c('navyblue','red'),
numbers=TRUE, sortVars=TRUE, labels=names(luftqual.A3), cex.axis=0.7, gap=0.1, ylab=c("Histogram of missing data","Pattern"), cex.lab = 0.7)
aggr_plot <- aggr(luftqual.A3, col=c('navyblue','red'),
numbers=TRUE, sortVars=TRUE, labels=names(luftqual.A3), cex.axis=0.7, gap=0, ylab=c("Histogram of missing data","Pattern"), cex.lab = 0.7)
aggr_plot <- aggr(luftqual.A3, col=c('navyblue','red'),
numbers=TRUE, sortVars=TRUE, labels=names(luftqual.A3), cex.axis=0.7, gap=0.5, ylab=c("Histogram of missing data","Pattern"), cex.lab = 0.7)
aggr_plot <- aggr(luftqual.A3, col=c('navyblue','red'),
numbers=TRUE, sortVars=TRUE, labels=names(luftqual.A3), cex.axis=0.7, gap=0.5, ylab=c("Histogram of missing data","Pattern"), cex.lab = 1)
