{
    "collab_server" : "",
    "contents" : "# Hausaufgabe\n#### Aufgabe 1 ####\n\nlibrary(\"tidyr\")\nlibrary(readr)\nrequire(dplyr, quietly = T)\nlibrary(ggplot2)\n\n# Daten einlesen\nugz_luftqualitaetsmessung_seit_2012 <- read_csv(\"ugz_luftqualitaetsmessung_seit-2012.csv\")\nluftqualitaet <- as_tibble(ugz_luftqualitaetsmessung_seit_2012)\n\n# Werte und titel separieren\ntitel <- slice(luftqualitaet, c(2))\ntitel[1] <- \"Datum\"\nwerte <- slice(luftqualitaet, c(-1:-5))\n\n# Tabelle nach ort auseinander nehmen\nstampfenbach <- werte %>% select(1,2:14) %>%\n  mutate(station = \"Stampfenbachstrasse\")\nstampfenbach_titel <- titel %>% select(1,2:14)\nstampfenbach_titel[15] <- \"Station\"\nnames(stampfenbach) <- stampfenbach_titel\n\nschimmel <- werte %>% select(1,15:22) %>%\n  mutate(station = \"Schimmelstrasse\")\nschimmel_titel <- titel %>% select(1,15:22)\nschimmel_titel[10] <- \"Station\"\nnames(schimmel) <- schimmel_titel\n\nheubeer <- werte %>% select(1,23:26) %>%\n  mutate(station = \"Heubeerib端el\")\nheubeer_titel <- titel %>% select(1,23:26)\nheubeer_titel[6] <- \"Station\"\nnames(heubeer) <- heubeer_titel\n\nrosengarten <- werte %>% select(1,27:30) %>%   \n  mutate(station = \"Rosengarten\")\nrosengarten_titel <- titel %>% select(1,27:30)\nrosengarten_titel[6] <- \"Station\"\nnames(rosengarten) <- rosengarten_titel\n\n# Tabelle zusammensetzen\nluftqual <- bind_rows(stampfenbach, schimmel, heubeer, rosengarten)\nstr(luftqual)\n\n# Zahlen von character nach numeric wandeln\nluftqual[2:14] <- as_tibble(sapply(luftqual[2:14], as.numeric))\nstr(luftqual)\nView(luftqual)\n\n\n\n#### Aufgabe 2 ####\n# mit ggplot\ngather(luftqual, key = variable, value = value, c(2,3,4,6,7,8)) %>% \n  ggplot(aes(x = Datum, y = value, group = variable)) +\n  geom_line(aes(color = variable)) +\n  facet_wrap(~Station)\n\n# mit ggally #falscher Ansatz\n# library(GGally)\n# ggpairs(luftqual, mapping = ggplot2::aes(color = Station), columns = c(2,3,4,6,7,8),\n#         upper =list(continuous = wrap(\"points\", alpha = 0.2)))\n\n\n#### Aufgabe 3 ####\nlibrary(VIM)\npar(mar= c(4,2,2,2))\n\n\n# All Nan Werte zu NA`s ersetzen\nluftqual.A3 <- rapply(luftqual, f=function(x) ifelse(is.nan(x),NA,x), how=\"replace\")\nView(luftqual.A3)\n\n# Neue Namen f端r Header, ansonsten kein Platz f端r Plot\nnames(luftqual.A3) <- c(\"Datum\", \"SO2\", \"CO\", \"O3_max_h1\", \"O3_nb_h1>120\", \"NO2\", \"NO\", \"PM10\", \"T\", \"Hr\", \"p\", \"WVS\", \"StrGlo\", \"RainDur\", \"Station\")\nView(luftqual.A3)\n\n# Anteil NA in Variable und Kombinationen von Varibablen\naggr_plot <- aggr(luftqual.A3, col=c('navyblue','red'), \n                  numbers=TRUE, sortVars=TRUE, labels=names(luftqual.A3), cex.axis=.7, gap=3, ylab=c(\"Histogram of missing data\",\"Pattern\"), cex.lab = 1.2)\n\n# Anzahl NA`s im Datensatz\nsum(is.na(luftqual.A3))\n\n\n\n\n#### Aufgabe 4 ####\n\n# Feinstaub (PM10) jeweils fuer die Messpunkte \n# Stampfenbachstrasse, Schimmelstrasse, Rosengartenstrasse\n# !! Heubeerib端el hat keine Messung von PM10 \n\n# PM10 \n# Jahresmittelgrenzwert: 20ug/m^3\n# Tagesmittelgrenzwert: 50ug/m^3, darf max. 1x pro Jahr ueberschritten werden\n\n\n# uberschittene Tagesmittelgrenzwerte\nluftqual.PM10 <- luftqual %>% select(Datum, 'Feinstaub PM10', Station) %>%\n  mutate(PM10_uberschritt = luftqual$`Feinstaub PM10` >= 50 )\n\n#1 wie oft wird der Tagesmittel-Grenzwert an welcher Station ueberschritten?\nluftqual.PM10 %>% group_by(Station) %>% summarize(n = sum(PM10_uberschritt, na.rm = T))\n\n#2 ueberschrittenen Tagesmittelgrenzwerte fuer alle Stationen ueber die Zeit in einer Grafik\nluftqual.PM10 %>% filter(PM10_uberschritt) %>% \n  ggplot(aes(x=Datum, y=`Feinstaub PM10`)) + geom_point(aes(color = Station)) + ggtitle(\"PM10 > 50\")\n\n# Der Tagesmittelgrenzwert wird bei allen Stationen oft an den gleichen Tagen uebertroffen.\n# Dies ist gut moeglich da alle Messstatinen unter aehnlichen Einfluessen auf den Feinstaub reagieren\n# wie zb. das Wetter.\n\n#3 In welchen Jahren und Stationen ist der Anteil der Tage mit Grenzwert uberschreitungen\n# signifikant groesser als zufaellig\n\n# Jahresmittelgrenzwert = 20ug/m^3\n\n# Messwerte sind iid: independent and identically distributed\nluftqual.PM10 %>% group_by(Station) %>% summarize(n = sum(PM10_uberschritt, na.rm = T)) %>%\n  mutate(wkeit_n = punif(q=n, min=0, max=365))\n\n#### nicht sicher obe uniform Verteilung stimmt.\n\n\n#### Aufgabe 5 ####\n\n# Regendauer ~ PM10 pro Station \n# select(luftqual, Datum, Regendauer)\n# PM10_temp <- luftqual %>% select(Datum,`Feinstaub PM10`, Station) %>%\n  \n# regendauer zu allen Stationen hinzufuegen mit leftjoin\nordered_PM10 <- left_join(x = select(luftqual, Datum,`Feinstaub PM10`, Station),\n          y = filter(luftqual, Station == \"Stampfenbachstrasse\") %>% select( Datum, Regendauer),\n          by = \"Datum\")\n  \n# Plot\nggplot(ordered_PM10, aes(x= Regendauer, y= `Feinstaub PM10`)) + geom_point(aes(color = Station))\n\n",
    "created" : 1544558865422.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "4282139804",
    "id" : "B318F021",
    "lastKnownWriteTime" : 1544559281,
    "last_content_update" : 1544559281922,
    "path" : "~/GitHub/Wast-Hausaufgabe/HA_main.R",
    "project_path" : "HA_main.R",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}